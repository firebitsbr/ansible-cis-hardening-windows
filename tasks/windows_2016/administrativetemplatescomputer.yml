---
- hosts: win2k16
  gather_facts: no
  tasks:
    - name: "18.1.1 (L1) Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization
              name: "NoLockScreenCamera"
              data: "1"
              type: dword

    - name: "18.1.2 (L1) Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Personalization
              name: "NoLockScreenSlideshow"
              data: "1"
              type: dword

    - name: 18.1.2.2 (L1) Ensure 'Allow input personalization' is set to 'Disabled'
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\InputPersonalization\
              name: "AllowInputPersonalization"
              data: "0"
              type: dword     
              
    - name: "18.2.2 (L1) Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled' (MS only)"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft Services\AdmPwd
              name: "PwdExpirationProtectionEnabled"
              data: "1"
              type: dword     
              
    - name: "18.2.3 (L1) Ensure 'Enable Local Admin Password Management' is set to 'Enabled' (MS only)"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft Services\AdmPwd
              name: "AdmPwdEnabled"
              data: "1"
              type: dword     
              
    - name: "18.2.4 (L1) Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters' (MS only)"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft Services\AdmPwd
              name: "PasswordComplexity"
              data: "4"
              type: dword                  

    - name: "18.2.5 (L1) Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more' (MS only)"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft Services\AdmPwd
              name: "PasswordLength"
              data: "15"
              type: dword      
              
    - name: "18.2.6 (L1) Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer' (MS only)"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft Services\AdmPwd
              name: "PasswordAgeDays"
              data: "30"
              type: dword                        

    - name: "18.3.1 (L1) Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled' (MS only)"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
              name: "LocalAccountTokenFilterPolicy"
              data: "0"
              type: dword

    - name: "18.3.2 (L1) Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Services\MrxSmb10
              name: "Start"
              data: "4"
              type: dword
              
    - name: "18.3.3 (L1) Ensure 'Configure SMB v1 cserver' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
              name: "SMB1"
              data: "0"
              type: dword

    - name: "18.3.4 (L1) Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\kernel
              name: "DisableExceptionChainValidation"
              data: "0"
              type: dword  
              
    - name: "18.3.5 (L1) Ensure 'Turn on Windows Defender protection against Potentially Unwanted Applications' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows Defender\MpEngine
              name: "MpEnablePus"
              data: "1"
              type: dword   

    - name: "18.3.6 (L1) Ensure 'Turn on Windows Defender protection against Potentially Unwanted Applications' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest
              name: "UseLogonCredential"
              data: "0"
              type: dword                 

    - name: "18.4.1 (L1) Ensure 'MSS: (AutoAdminLogon) Enable Automatic Logon (not recommended)' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
              name: "AutoAdminLogon"
              data: "0"
              type: string      
              
    - name: "18.4.2 (L1) Ensure 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'"
      win_regedit:
              path: HKLM:\System\CurrentControlSet\Services\Tcpip6\Parameters
              name: "DisableIPSourceRouting"
              data: "2"
              type: dword         
              
    - name: "18.4.3 (L1) Ensure 'MSS: (DisableIPSourceRouting) IP source routing protection level (protects against packet spoofing)' is set to 'Enabled: Highest protection, source routing is completely disabled'"
      win_regedit:
              path: HKLM:\System\CurrentControlSet\Services\Tcpip\Parameters
              name: "DisableIPSourceRouting"
              data: "2"
              type: dword    
              
    - name: "18.4.4 (L1) Ensure 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\System\CurrentControlSet\Services\Tcpip\Parameters
              name: "EnableICMPRedirect"
              data: "0"
              type: dword      
              
    - name: "18.4.6 (L1) Ensure 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\System\CurrentControlSet\Services\Netbt\Parameters
              name: "NoNameReleaseOnDemand"
              data: "1"
              type: dword     
              
    - name: "18.4.8 (L1) Ensure 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode (recommended)' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager
              name: "SafeDllSearchMode"
              data: "1"
              type: dword   
              
    - name: "18.4.9 (L1) Ensure 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires (0 recommended)' is set to 'Enabled: 5 or fewer seconds'"
      win_regedit:
              path: HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon
              name: "ScreenSaverGracePeriod"
              data: "0"
              type: dword       
              
    - name: "18.4.12 (L1) Ensure 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set to 'Enabled: 90% or less'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Services\Eventlog\Security
              name: "WarningLevel"
              data: "90"
              type: dword                     

    - name: "18.5.4.1 (L1) Set 'NetBIOS node type' to 'P-node' (Ensure NetBT Parameter 'NodeType' is set to '0x2 (2)') (MS Only)"
      win_regedit:
              path: HKLM:\System\CurrentControlSet\Services\NetBT\Parameters
              name: "NodeType"
              data: "2"
              type: dword

    - name: "18.5.4.2 (L1) Ensure 'Turn off multicast name resolution' is set to 'Enabled' (MS Only)"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\DNSClient
              name: "EnableMulticast"
              data: "0"
              type: dword

    - name: "18.5.8.1 (L1) Ensure 'Enable insecure guest logons' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows\LanmanWorkstation
              name: "AllowInsecureGuestAuth"
              data: "0"
              type: dword

    - name: "18.5.11.2 (L1) Ensure 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
              name: "NC_AllowNetBridge_NLA"
              data: "0"
              type: dword

    - name: "18.5.11.3 (L1) Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
              name: "NC_ShowSharedAccessUI"
              data: "0"
              type: dword

    - name: "18.5.11.4 (L1) Ensure 'Require domain users to elevate when setting a network's location' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections
              name: "NC_StdDomainUserSetLocation"
              data: "1"
              type: dword

    - name: "18.5.21.1 (L1) Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WcmSvc\GroupPolicy
              name: "fMinimizeConnections"
              data: "1"
              type: dword

    - name: "18.8.21.5 (L1) Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System
              name: "DisableBkGndGroupPolicy"
              data: "0"
              type: dword

    - name: "18.8.3.1 (L1) Ensure 'Include command line in process creation events' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit
              name: "ProcessCreationIncludeCmdLine_Enabled"
              data: "0"
              type: dword

    - name: "18.8.4.1 (L1) Ensure 'Remote host allows delegation of non-exportable credentials' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\CredentialsDelegation
              name: "AllowProtectedCreds"
              data: "1"
              type: dword

    - name: "18.8.14.1 (L1) Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'"
      win_regedit:
              path: HKLM:\SYSTEM\CurrentControlSet\Policies\EarlyLaunch
              name: "DriverLoadPolicy"
              data: "3"
              type: dword

    - name: "18.8.21.2 (L1) Ensure 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}
              name: "NoBackgroundPolicy"
              data: "0"
              type: dword

    - name: "18.8.21.3 (L1) Ensure 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Group Policy\{35378EAC-683F-11D2-A89A-00C04FBBCFA2}
              name: "NoGPOListChanges"
              data: "0"
              type: dword

    - name: 18.8.21.4 (L1) Ensure 'Continue experiences on this device' is set to 'Disabled'
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "EnableCdp"
              data: "0"
              type: dword

    - name: 18.8.21.5 (L1) Ensure 'Turn off background refresh of Group Policy' is set to 'Disabled'
      win_regedit:
              path: HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System
              name: "DisableBkGndGroupPolicy"
              data: "1"
              type: dword

    - name: "18.8.22.1.1 (L1) Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers
              name: "DisableWebPnPDownload"
              data: "1"
              type: dword

    - name: "18.8.22.1.5 (L1) Ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
              name: "NoWebServices"
              data: "1"
              type: dword

    - name: "18.8.22.1.6 (L1) Ensure 'Turn off printing over HTTP' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Printers
              name: "DisableHTTPPrinting"
              data: "1"
              type: dword

    - name: "18.8.27.1 (L1) Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "BlockUserFromShowingAccountDetailsOnSignin"
              data: "1"
              type: dword

    - name: "18.8.27.2 (L1) Ensure 'Do not display network selection UI' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "DontDisplayNetworkSelectionUI"
              data: "1"
              type: dword              

    - name: "18.8.27.3 (L1) Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "DontEnumerateConnectedUsers"
              data: "1"
              type: dword

    - name: "18.8.27.4 (L1) Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled' (MS only)"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "EnumerateLocalUsers"
              data: "0"
              type: dword

    - name: "18.8.27.5 (L1) Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "DisableLockScreenAppNotifications"
              data: "1"
              type: dword

    - name: "18.8.27.6 (L1) Ensure 'Turn off picture password sign-in' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "BlockDomainPicturePassword"
              data: "1"
              type: dword

    - name: "18.8.27.7 (L1) Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
              name: "AllowDomainPINLogon"
              data: "0"
              type: dword

    - name: "18.8.28.1 (L1) Ensure 'Untrusted Font Blocking' is set to 'Enabled: Block untrusted fonts and log events'" 
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\MitigationOptions
              name: "MitigationOptions_FontBocking"
              data: "1000000000000"
              type: string

    - name: "18.8.33.6.1 (L1) Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51
              name: "DCSettingIndex"
              data: "1"
              type: dword

    - name: "18.8.33.6.2 (L1) Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Power\PowerSettings\0e796bdb-100d-47d6-a2d5-f7d2daa51f51
              name: "ACSettingIndex"
              data: "1"
              type: dword

    - name: "18.8.35.1 (L1) Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "fAllowUnsolicited"
              data: "0"
              type: dword

    - name: "18.8.35.2 (L1) Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "fAllowToGetHelp"
              data: "0"
              type: dword

    - name: "18.8.36.1 (L1) Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled' (MS only)"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Rpc
              name: "EnableAuthEpResolution"
              data: "1"
              type: dword  
    - name: "18.9.6.1 (L1) Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
              name: "MSAOptional"
              data: "1"
              type: dword

    - name: "18.9.8.1 (L1) Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
              name: "NoAutoplayfornonVolume"
              data: "1"
              type: dword

    - name: "18.9.8.2 (L1) Ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
              name: "NoAutorun"
              data: "1"
              type: dword

    - name: "18.9.8.3 (L1) Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
              name: "NoDriveTypeAutoRun"
              data: "255"
              type: dword

    - name: "18.9.10.1.1 (L1) Ensure 'Configure enhanced anti-spoofing' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Biometrics\FacialFeatures
              name: "EnhancedAntiSpoofing"
              data: "1"
              type: dword

    - name: "18.9.13.1 (L1) Ensure 'Turn off Microsoft consumer experiences' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\CloudContent
              name: "DisableWindowsConsumerFeatures"
              data: "1"
              type: dword

    - name: "18.9.14.1 (L1) Ensure 'Require pin for pairing' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Connect
              name: "RequirePinForPairing"
              data: "1"
              type: dword

    - name: "18.9.15.1 (L1) Ensure 'Do not display the password reveal button' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\CredUI
              name: "DisablePasswordReveal"
              data: "1"
              type: dword

    - name: "18.9.15.2 (L1) Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\CredUI
              name: "EnumerateAdministrators"
              data: "0"
              type: dword

    - name: "18.9.16.1 (L1) Ensure 'Allow Telemetry' is set to 'Enabled: 0 - Security [Enterprise Only]' or 'Enabled: 1 - Basic'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection
              name: "AllowTelemetry"
              data: "1"
              type: dword

    - name: "18.9.16.3 (L1) Ensure 'Disable pre-release features or settings' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds
              name: "EnableConfigFlighting"
              data: "0"
              type: dword              

    - name: "18.9.16.4 (L1) Ensure 'Do not show feedback notifications' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\DataCollection
              name: "DoNotShowFeedbackNotifications"
              data: "1"
              type: dword        

    - name: "18.9.16.5 (L1) Ensure 'Toggle user control over Insider builds' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PreviewBuilds
              name: "AllowBuildPreview"
              data: "0"
              type: dword    

    - name: "18.9.26.1.1 (L1) Ensure 'Application: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application
              name: "Retention"
              data: "0"
              type: string

    - name: "18.9.26.1.2 (L1) Ensure 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Application
              name: "MaxSize"
              data: "32768"
              type: dword

    - name: "18.9.26.2.1 (L1) Ensure 'Security: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security
              name: "Retention"
              data: "0"
              type: string

    - name: "18.9.26.2.2 (L1) Ensure 'Security: Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Security
              name: "MaxSize"
              data: "196608"
              type: dword

    - name: "18.9.26.3.1 (L1) Ensure 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup
              name: "Retention"
              data: "0"
              type: string

    - name: "18.9.26.3.2 (L1) Ensure 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\Setup
              name: "MaxSize"
              data: "32768"
              type: dword

    - name: "18.9.26.4.1 (L1) Ensure 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\System
              name: "Retention"
              data: "0"
              type: string

    - name: "18.9.26.4.2 (L1) Ensure 'System: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\EventLog\System
              name: "MaxSize"
              data: "32768"
              type: dword

    - name: "18.9.30.2 (L1) Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
              name: "NoDataExecutionPrevention"
              data: "0"
              type: dword

    - name: "18.9.30.3 (L1) Ensure 'Turn off heap termination on corruption' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Explorer
              name: "NoHeapTerminationOnCorruption"
              data: "0"
              type: dword

    - name: "18.9.30.4 (L1) Ensure 'Turn off shell protocol protected mode' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer
              name: "PreXPSP2ShellProtocolBehavior"
              data: "0"
              type: dword

    - name: "18.9.44.1 (L1) Ensure 'Block all consumer Microsoft account user authentication' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\MicrosoftAccount
              name: "DisableUserAuth"
              data: "1"
              type: dword              

    - name: "18.9.52.1 (L1) Ensure 'Prevent the usage of OneDrive for file storage' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive
              name: "DisableFileSyncNGSC"
              data: "1"
              type: dword

    - name: "18.9.52.2 (L1) Ensure 'Prevent the usage of OneDrive for file storage on Windows 8.1' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\OneDrive
              name: "DisableFileSync"
              data: "1"
              type: dword

    - name: "18.9.58.2.2 (L1) Ensure 'Do not allow passwords to be saved' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "DisablePasswordSaving"
              data: "1"
              type: dword

    - name: "18.9.58.3.3.2 (L1) Ensure 'Do not allow drive redirection' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "fDisableCdm"
              data: "1"
              type: dword

    - name: "18.9.58.3.9.1 (L1) Ensure 'Always prompt for password upon connection' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "fPromptForPassword"
              data: "1"
              type: dword

    - name: "18.9.58.3.9.2 (L1) Ensure 'Require secure RPC communication' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "fEncryptRPCTraffic"
              data: "1"
              type: dword

    - name: "18.9.58.3.9.3 (L1) Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "MinEncryptionLevel"
              data: "3"
              type: dword

    - name: "18.9.58.3.11.1 (L1) Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "DeleteTempDirsOnExit"
              data: "1"
              type: dword

    - name: "18.9.58.3.11.2 (L1) Ensure 'Do not use temporary folders per session' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services
              name: "PerSessionTempDir"
              data: "1"
              type: dword

    - name: "18.9.59.1 (L1) Ensure 'Prevent downloading of enclosures' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Feeds
              name: "DisableEnclosureDownload"
              data: "1"
              type: dword

    - name: "18.9.60.2 (L1) Ensure 'Allow indexing of encrypted files' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Windows Search
              name: "AllowIndexingEncryptedStoresOrItems"
              data: "0"
              type: dword

    - name: "18.9.76.14 (L1) Ensure 'Turn off Windows Defender AntiVirus' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
              name: "DisableAntiSpyware"
              data: "0"
              type: dword

    - name: "18.9.76.3.1 (L1) Ensure 'Configure local setting override for reporting to Microsoft MAPS' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Spynet
              name: "LocalSettingOverrideSpynetReporting"
              data: "0"
              type: dword

    - name: "18.9.76.7.1 (L1) Ensure 'Turn on behavior monitoring' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Real-Time Protection
              name: "DisableBehaviorMonitoring"
              data: "0"
              type: dword

    - name: "18.9.76.10.1 (L1) Ensure 'Scan removable drives' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Scan
              name: "DisableRemovableDriveScanning"
              data: "0"
              type: dword

    - name: "18.9.76.10.2 (L1) Ensure 'Turn on e-mail scanning' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender\Scan
              name: "DisableEmailScanning"
              data: "0"
              type: dword

    - name: "18.9.76.13.1.1 (L1) Ensure 'Configure Attack Surface Reduction rules' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR
              name: "ExploitGuard_ASR_Rules"
              data: "1"
              type: dword      

    - name: "18.9.76.13.1.2 (L1) Ensure 'Configure Attack Surface Reduction rules: Set the state for each ASR rule' is 'configured'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\ASR
              name: "75668c1f-73b5-4cf0-bb93-3ecf5cb7cc84"
              data: "1"
              type: string           
              
    - name: "18.9.76.13.3.1 (L1) Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled: Block'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows Defender\Windows Defender Exploit Guard\Network Protection
              name: "EnableNetworkProtection"
              data: "1"
              type: dword   

    - name: "18.9.79.1 (L1) Ensure 'Prevent users from modifying settings' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection
              name: "DisallowExploitProtectionOverride"
              data: "1"
              type: dword                 
              
    - name: "18.9.80.1.1_1 (L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows\System
              name: "EnableSmartScreen"
              data: "1"
              type: dword

    - name: "18.9.80.1.1_2 (L1) Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'"      
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows\System
              name: "ShellSmartScreenLevel"
              data: "Block"
              type: string              

    - name: "18.9.81.3 (L1) Ensure 'Automatically send memory dumps for OS-generated error reports' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting
              name: "AutoApproveOSDumps"
              data: "0"
              type: dword

    - name: "18.9.81.2.1 (L1) Ensure 'Configure Default consent' is set to 'Enabled: Always ask before sending data'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Windows Error Reporting\Consent
              name: "DefaultConsent"
              data: "1"
              type: dword

    - name: "18.9.84.2 (L1) Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: On, but disallow access above lock' OR 'Disabled' but not 'Enabled: On'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\WindowsInkWorkspace
              name: "AllowWindowsInkWorkspace"
              data: "1"
              type: dword              

    - name: "18.9.85.1 (L1) Ensure 'Allow user control over installs' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer
              name: "EnableUserControl"
              data: "0"
              type: dword

    - name: "18.9.85.2 (L1) Ensure 'Always install with elevated privileges' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\Installer
              name: "AlwaysInstallElevated"
              data: "0"
              type: dword

    - name: "18.9.86.1 (L1) Ensure 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System:DisableAutomaticRestartSignOn
              name: "DisableAutomaticRestartSignOn"
              data: "0"
              type: dword

    - name: "18.9.86.1 (L1) Ensure 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
              name: "DisableAutomaticRestartSignOn"
              data: "1"
              type: dword

    - name: "18.9.95.1 (L1) Ensure 'Turn on PowerShell Script Block Logging' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
              name: "EnableScriptBlockLogging"
              data: "0"
              type: dword

    - name: "18.9.95.2 (L1) Ensure 'Turn on PowerShell Transcription' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\Transcription
              name: "EnableTranscripting"
              data: "0"
              type: dword

    #- name: "18.9.97.1.1 (L1) Ensure 'Allow Basic authentication' is set to 'Disabled'"
    #  win_regedit:
    #          path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client
    #          name: "AllowBasic"
    #          data: "0"
    #          type: dword

    - name: "18.9.97.1.2 (L1) Ensure 'Allow unencrypted traffic' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Client
              name: "AllowUnencryptedTraffic"
              data: "0"
              type: dword

    - name: "18.9.97.1.3 (L1) Ensure 'Disallow Digest authentication' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows\WinRM\Client
              name: "AllowDigest"
              data: "0"
              type: dword

    #- name: "18.9.97.2.1 (L1) Ensure 'Allow Basic authentication' is set to 'Disabled'"
    #  win_regedit:
    #          path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
    #          name: "AllowBasic"
    #          data: "0"
    #          type: dword

    - name: "18.9.97.2.3 (L1) Ensure 'Allow unencrypted traffic' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
              name: "AllowUnencryptedTraffic"
              data: "0"
              type: dword

    - name: "18.9.97.2.4 (L1) Ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WinRM\Service
              name: "DisableRunAs"
              data: "1"
              type: dword   

    - name: "18.9.100.2 (L1) Ensure 'Configure Automatic Updates' is set to 'Enabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "NoAutoUpdate"
              data: "1"
              type: dword

    - name: "18.9.100.3 (L1) Ensure 'Configure Automatic Updates: Scheduled install day' is set to '0 - Every day'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "ScheduledInstallDay"
              data: "0"
              type: dword

    - name: "18.9.100.4 (L1) Ensure 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "NoAutoRebootWithLoggedOnUsers"
              data: "0"
              type: dword

    - name: "18.9.101.1.1_1 (L1) Ensure 'Manage preview builds' is set to 'Enabled: Disable preview builds'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "ManagePreviewBuilds"
              data: "1"
              type: dword
              
    - name: "18.9.101.1.1_2 (L1) Ensure 'Manage preview builds' is set to 'Enabled: Disable preview builds'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "ManagePreviewBuildsPolicyValue"
              data: "1"
              type: dword                        
              
    - name: "18.9.101.1.2_1 (L1) Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled: Semi-Annual Channel, 180 or more days'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "DeferFeatureUpdates"
              data: "1"
              type: dword        

    - name: "18.9.101.1.2_2 (L1) Ensure 'Select when Preview Builds and Feature Updates are received' is set to 'Enabled: Semi-Annual Channel, 180 or more days'"      
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "BranchReadinessLevel"
              data: "32"
              type: dword    

    - name: "18.9.101.1.3_1 (L1) Ensure 'Select when Quality Updates are received' is set to 'Enabled: 0 days'"
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "DeferQualityUpdates"
              data: "1"
              type: dword         
              
    - name: "18.9.101.1.3_2 (L1) Ensure 'Select when Quality Updates are received' is set to 'Enabled: 0 days'"  
      win_regedit:
              path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "DeferQualityUpdatesPeriodInDays"
              data: "0"
              type: dword      
              
    - name: "18.9.101.2 (L1) Ensure 'Configure Automatic Updates' is set to 'Enabled'"  
      win_regedit:
              path: HKLM:\Software\Policies\Microsoft\Windows\WindowsUpdate\AU
              name: "NoAutoUpdate"
              data: "0"
              type: dword                 